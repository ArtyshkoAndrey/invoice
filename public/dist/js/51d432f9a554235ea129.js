"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[57],{1057:(t,s,e)=>{e.r(s),e.d(s,{default:()=>d});var a=e(7757),n=e.n(a),o=e(266),i=e(9669),r=e.n(i);function l(t,s,e,a,n,o,i){try{var r=t[o](i),l=r.value}catch(t){return void e(t)}r.done?s(l):Promise.resolve(l).then(a,n)}const c={name:"Edit",components:{Loader:e(7410).Z},metaInfo:{title:o.Z.t("samples.edit.title")},data:function(){return{title:o.Z.t("samples.edit.title"),sample:{},resorts:[],loading:!0}},computed:{id:function(){return this.$route.params.id}},mounted:function(){var t,s=this;return(t=n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r().get("/api/samples/"+s.id).then((function(t){s.sample=t.data.payload.sample})).catch((function(t){404===t.response.status&&(console.log(t.response.data),s.$vs.notification({title:"Ошибка",text:t.response.data.message}),s.$router.push({name:"dashboard.samples.index"}))}));case 2:return t.next=4,r().get("/api/resorts").then((function(t){s.resorts=t.data.payload.resorts}));case 4:return t.next=6,s.$root.$loading.finish();case 6:s.loading=!1;case 7:case"end":return t.stop()}}),t)})),function(){var s=this,e=arguments;return new Promise((function(a,n){var o=t.apply(s,e);function i(t){l(o,a,n,i,r,"next",t)}function r(t){l(o,a,n,i,r,"throw",t)}i(void 0)}))})()},methods:{addDay:function(){this.sample.days.push({id:"",order:"",resort:{id:""},free:!1})},removeDay:function(t){this.sample.days=this.sample.days.filter((function(s,e){return e!==t}))},save:function(){var t=this;this.$root.$loading.start(),r().put("/api/days",{sample:this.sample}).then((function(s){t.$root.$loading.finish(),console.log("save data",s.data.payload),t.$router.go(-1)})).catch((function(s){t.$root.$loading.finish(),422===s.response.status?(t.$vs.notification({title:"Ошибка",text:s.response.data.message}),Object.keys(s.response.data.errors).forEach((function(e){t.$vs.notification({title:e.capitalize(),text:s.response.data.errors[e]})}))):404===s.response.status&&t.$vs.notification({title:"Ошибка",text:s.response.data.message})}))}}};const d=(0,e(1900).Z)(c,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("transition",{attrs:{name:"fade",appear:""}},[t.$root.$loading.show&&t.loading?e("Loader",{key:"1"}):e("div",{key:"2"},[e("div",{staticClass:"card p-4"},[e("div",{staticClass:"card-title"},[e("h3",[t._v(t._s(t.$t("samples.edit.title"))+' "'+t._s(t.sample.name)+'"')])]),t._v(" "),e("div",{staticClass:"card-body px-0"},[t._l(t.sample.days,(function(s,a){return e("div",{key:a,staticClass:"row align-items-center my-2"},[e("div",{staticClass:"col-lg-auto col-sm-2 col-4"},[e("p",{staticClass:"mb-0"},[t._v(t._s(t.$t("samples.edit.day",{number:a+1})))])]),t._v(" "),e("div",{staticClass:"col-lg-auto col-sm-4 col-8"},[e("vs-select",{attrs:{placeholder:"Курорты"},model:{value:s.resort.id,callback:function(e){t.$set(s.resort,"id",e)},expression:"day.resort.id"}},t._l(t.resorts,(function(s){return e("vs-option",{key:s.id,attrs:{label:s.name,value:s.id}},[t._v("\n                  "+t._s(s.name)+"\n                ")])})),1)],1),t._v(" "),e("div",{staticClass:"col-lg-auto col-sm-2 col-6 mt-2 mt-lg-0"},[e("vs-checkbox",{model:{value:s.free,callback:function(e){t.$set(s,"free",e)},expression:"day.free"}},[t._v("\n                "+t._s(t.$t("samples.edit.free_day"))+"\n              ")])],1),t._v(" "),e("div",{staticClass:"col-lg-auto col-sm col-6 mt-2 mt-lg-0"},[e("vs-button",{attrs:{circle:"",danger:"",flat:""},on:{click:function(s){return t.removeDay(a)}}},[e("em",{staticClass:"bx bx-trash-alt d-none d-lg-block"}),t._v(" "),e("span",{staticClass:"d-block d-lg-none"},[t._v(t._s(t.$t("form.delete")))])])],1),t._v(" "),e("div",{staticClass:"col-12"},[e("hr",{staticClass:"d-block d-lg-none"})])])})),t._v(" "),e("div",{staticClass:"row justify-content-between align-items-center mt-3"},[e("div",{staticClass:"col-auto"},[e("vs-button",{attrs:{gradient:""},on:{click:t.addDay}},[t._v("\n                "+t._s(t.$t("samples.edit.add_day"))+"\n              ")])],1),t._v(" "),e("div",{staticClass:"col-auto"},[e("vs-button",{attrs:{success:""},on:{click:t.save}},[t._v("\n                "+t._s(t.$t("form.save"))+"\n              ")])],1)])],2)])])],1)],1)}),[],!1,null,"0c6202ae",null).exports}}]);