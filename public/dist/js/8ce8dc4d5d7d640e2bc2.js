"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[154],{5540:(t,e,a)=>{a.d(e,{Z:()=>s});var n=a(1519),i=a.n(n)()((function(t){return t[1]}));i.push([t.id,".fruit-list-item[data-v-13f8ebe3]{transition:all 1s}.fruit-list-enter[data-v-13f8ebe3],.fruit-list-leave-to[data-v-13f8ebe3]{max-height:0;overflow:hidden;padding-bottom:0!important;padding-top:0!important}.fruit-list-enter-to[data-v-13f8ebe3],.fruit-list-leave[data-v-13f8ebe3]{max-height:80px}.fruit-table-item[data-v-13f8ebe3]{transition:all 1s}.fruit-table-item>*[data-v-13f8ebe3]{overflow:hidden;transition:all 1s}.fruit-table-enter[data-v-13f8ebe3],.fruit-table-leave-to[data-v-13f8ebe3]{line-height:0}.fruit-table-enter>*[data-v-13f8ebe3],.fruit-table-leave-to>*[data-v-13f8ebe3]{padding-bottom:0!important;padding-top:0!important}",""]);const s=i},8154:(t,e,a)=>{a.r(e),a.d(e,{default:()=>x});var n=a(7757),i=a.n(n),s=a(9669),r=a.n(s),o=a(9319),l=a(8318),c=a(538);const d={name:"EditItemsModal",props:{bus:{type:c.default,required:!0}},data:function(){return{active:!1,name:"",nameTitle:"",id:null,loading:!1,error:null}},mounted:function(){this.bus.$on("openModal",this.openModal)},methods:{openModal:function(t){this.name=t.name,this.nameTitle=t.name,this.id=t.id,this.active=!0},update:function(){this.loading=!0,this.bus.$emit("update",{id:this.id,name:this.name,callbackSuccess:this.callbackSuccess,callbackError:this.callbackError})},callbackSuccess:function(){this.active=!1,this.loading=!1,this.error=null},callbackError:function(t){this.loading=!1,this.error=t}}};var u=a(1900);const f={name:"ItemCardOneField",components:{EditItemsModal:(0,u.Z)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vs-dialog",{attrs:{width:"300px","not-center":"",loading:t.loading},scopedSlots:t._u([{key:"header",fn:function(){return[a("h4",{staticClass:"not-margin"},[t._v("\n      "+t._s(t.$t("resorts.edit-modal.title"))+" "),a("strong",[t._v(t._s(t.nameTitle))])])]},proxy:!0},{key:"footer",fn:function(){return[a("div",{staticClass:"row justify-content-around align-items-center"},[a("div",{staticClass:"col-auto"},[a("vs-button",{attrs:{success:"",flat:""},on:{click:t.update}},[t._v("\n          "+t._s(t.$t("form.save"))+"\n        ")])],1),t._v(" "),a("div",{staticClass:"col-auto"},[a("vs-button",{attrs:{danger:"",flat:""},on:{click:function(e){t.active=!1}}},[t._v("\n          "+t._s(t.$t("form.cancel"))+"\n        ")])],1)])]},proxy:!0}]),model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._v(" "),a("div",{staticClass:"con-content"},[a("vs-input",{attrs:{placeholder:t.$t("form.inputs.name.placeholder")},scopedSlots:t._u([t.error?{key:"message-danger",fn:function(){return[t._v("\n        "+t._s(t.error)+"\n      ")]},proxy:!0}:null],null,!0),model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)])}),[],!1,null,"6c92071e",null).exports},props:{name:{type:String,required:!0},id:{type:Number,required:!0}},data:function(){return{bus:new c.default}},mounted:function(){this.bus.$on("update",this.update)},methods:{openModal:function(){this.bus.$emit("openModal",{name:this.name,id:this.id})},update:function(t){this.$emit("update",t)}}};const v=(0,u.Z)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"row align-items-center mx-0"},[a("div",{staticClass:"col"},[a("h6",{staticClass:"mb-0"},[t._v("\n            "+t._s(t.name)+"\n          ")])]),t._v(" "),a("div",{staticClass:"col-auto"},[a("div",{staticClass:"row gx-0"},[a("div",{staticClass:"col"},[a("vs-button",{attrs:{icon:"",circle:"",success:"",flat:""},on:{click:t.openModal}},[a("em",{staticClass:"bx bx-pencil"})])],1),t._v(" "),a("div",{staticClass:"col"},[a("vs-button",{attrs:{icon:"",circle:"",danger:"",flat:""},on:{click:function(e){return t.$emit("destroy",t.id)}}},[a("em",{staticClass:"bx bx-trash-alt"})])],1)])])])])]),t._v(" "),a("EditItemsModal",{attrs:{bus:t.bus}})],1)}),[],!1,null,"0a1d4840",null).exports;var p=a(266);function m(t,e,a,n,i,s,r){try{var o=t[s](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,i)}const h={name:"Index",components:{Loader:o.Z,HeaderFilterInfo:l.Z,ItemCardOneField:v},data:function(){return{title:p.Z.t("resorts.index.title"),viewLength:10,resorts:{},filter:new c.default}},metaInfo:{title:p.Z.t("resorts.index.title")},mounted:function(){var t,e=this;return(t=i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$root.$loading.set(50);case 2:return t.next=4,r().get("/api/resorts",{params:{per_page:e.viewLength}}).then((function(t){console.log(t.data),e.resorts=t.data.payload.resorts,e.$root.$loading.finish()})).catch((function(t){console.log(t),e.$root.$loading.fail()}));case 4:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(n,i){var s=t.apply(e,a);function r(t){m(s,n,i,r,o,"next",t)}function o(t){m(s,n,i,r,o,"throw",t)}r(void 0)}))})()},methods:{get:function(t){var e=this;r().get("/api/resorts",{params:{per_page:this.viewLength,page:t.page,search:t.search}}).then((function(t){e.resorts=t.data.payload.resorts,e.filter.$emit("updateData",t.data.payload.resorts),console.log("new data",t.data)}))},setViewLength:function(t){this.viewLength=t},deleteItem:function(t){var e=this;r().delete("/api/resorts/"+t).then((function(t){e.$vs.notification({duration:2e3,sticky:!0,position:"top-right",color:"success",title:e.$t("notification.delete.success.title",{name:t.data.payload.resort.name}),text:e.$t("notification.delete.success.text",{name:t.data.payload.resort.name})}),e.get({page:e.$refs.filter.page,search:e.$refs.filter.value})})).catch((function(t){console.log(t)}))},update:function(t){var e=this;r().put("/api/resorts/"+t.id,{name:t.name}).then((function(a){a.data.success?(t.callbackSuccess(),e.get({page:e.$refs.filter.page,search:e.$refs.filter.value})):t.callbackError("Не предвиденная ошибка")})).catch((function(e){e.response.data.errors.name?t.callbackError(e.response.data.errors.name[0]):t.callbackError(e.response.data.message)}))}}};var g=a(3379),b=a.n(g),$=a(5540),_={insert:"head",singleton:!1};b()($.Z,_);$.Z.locals;const x=(0,u.Z)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.$root.$loading.show?a("Loader"):a("div",[a("HeaderFilterInfo",{ref:"filter",attrs:{values:t.resorts,"view-length":t.viewLength,title:t.$t("resorts.index.filter_title"),filter:t.filter},on:{get:t.get,setViewLength:t.setViewLength}}),t._v(" "),a("div",{staticClass:"row gy-3 mt-3"},t._l(t.resorts.data,(function(e){return a("div",{key:e.id,staticClass:"col-12"},[a("ItemCardOneField",{attrs:{id:e.id,name:e.name},on:{update:t.update,destroy:t.deleteItem}})],1)})),0)],1)}),[],!1,null,"13f8ebe3",null).exports}}]);